Automated Testing Framework (atf)
Copyright (c) 2007 The NetBSD Foundation, Inc.
All rights reserved.


Introduction
============

This document describes the procedure to create and publish a new ATF
release.  It is provided as a check-list, which must be followed in the
order provided.  If there is any problem in any step, it must be fixed
and the whole process must be restarted from scratch.


How to make a release
=====================

* Run 'make dist'.

* Sanity-check the resulting .tar.gz file as described in "How to
  sanity-check a distribution file".

* Tag the release in the repository, using a tag name that matches the
  distfile's base name.  Typically: atf-<major>.<minor>[.<micro>]

* Create a .cksums file with the tarball's checksums.  Put md5, sha1 and
  sha512 in them.  The first two are provided for convenience and the
  last one is provided for security.

* Create an .asc file with the tarball's signature made by the release
  manager.

* Publish the release as described in "How to publish a release".


How to sanity-check a distribution file
=======================================

* Unpack the tarball generated in the previous section into a temporary
  directory.

* Ensure the version number is correct.

* Ensure that the entry at the top of the NEWS document matches the version
  to be distributed and that its entry is complete.  In special, be aware
  of typos in it.

* Check that the README file properly documents which tools were used to
  generate the scripts in the release.  This includes the exact versions
  of GNU Automake, GNU Autoconf, GNU Libtool and GNU M4.  The reason is
  that we should be able to regenerate the file at any point in the future
  and get the exact same results.

* Configure and install the program using a temporary prefix.

* Run 'make check'.

* Build a complete release of NetBSD/i386 current, install it and run all
  the tests in it.  Store the output of this run.

* Import the new release into the NetBSD source tree.

* Rebuild and install the same NetBSD release, *without* updating the
  source tree.  Rerun all the tests in it.  Compare the output with the
  previous run and ensure there are no regressions caused by ATF itself.

* Update the ATF package in pkgsrc to the new release and ensure it builds
  and installs without any patches.  Run all the tests in prefix/tests to
  make sure they work.


How to publish a release
========================

* Upload the distfile, the .cksums file and the .asc file to the FTP
  server.  The current location for releases is:

  ftp://ftp.NetBSD.org/pub/NetBSD/misc/jmmv/atf/<major>.<minor>/

* Announce the new version in the ATF's web page.

* Announce the new version in the ATF's mailing list.

* Announce the new version in the ATF's project page at Freshmeat.net.


-- EOF
